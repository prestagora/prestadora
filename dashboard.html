<!-- ÁREA PRINCIPAL -->
<div class="main">

    <div class="topbar">
        <h1>Dashboard</h1>
        <button class="btn" id="btnMeta" onclick="loginFacebook()">Conectar Meta Ads</button>
    </div>

    <div class="card">
        <h3>Bem-vindo à Plataforma de Marketing</h3>
        <p>Gerencie suas contas, campanhas e relatórios de forma automatizada.</p>
    </div>

    <!-- ============================
          SEÇÃO DE CLIENTES
    ============================= -->
    <div class="card">
        <h3>Clientes</h3>

        <button class="btn" onclick="toggleFormCliente()">Adicionar Cliente</button>

        <!-- FORMULÁRIO OCULTO -->
        <div id="formCliente" style="display:none; margin-top:20px;">

            <label>Data início</label>
            <input id="cliente_inicio" type="date" style="width:100%; padding:8px; margin-bottom:10px;">

            <label>Data fim contrato</label>
            <input id="cliente_fim" type="date" style="width:100%; padding:8px; margin-bottom:10px;">

            <label>Nome do cliente</label>
            <input id="cliente_nome" type="text" placeholder="Nome completo" style="width:100%; padding:8px; margin-bottom:10px;">

            <label>Telefone</label>
            <input id="cliente_tel" type="text" placeholder="(00) 00000-0000" style="width:100%; padding:8px; margin-bottom:10px;">

            <label>E-mail</label>
            <input id="cliente_email" type="email" placeholder="email@exemplo.com" style="width:100%; padding:8px; margin-bottom:10px;">

            <label>CPF/CNPJ</label>
            <input id="cliente_doc" type="text" placeholder="000.000.000-00" style="width:100%; padding:8px; margin-bottom:10px;">

            <label>Valor do contrato (R$)</label>
            <input id="cliente_valor" type="number" placeholder="1000,00" style="width:100%; padding:8px; margin-bottom:10px;">

            <button class="btn" onclick="salvarCliente()">Salvar Cliente</button>
        </div>

        <hr style="margin:25px 0; opacity:0.3;">

        <h4>Lista de Clientes</h4>
        <div id="listaClientes"></div>

    </div>
</div>

<script>

    // Abrir/fechar formulário
    function toggleFormCliente() {
        const form = document.getElementById("formCliente");
        form.style.display = (form.style.display === "none") ? "block" : "none";
    }

    // SALVAR CLIENTE
    function salvarCliente() {

        const cliente = {
            inicio: document.getElementById("cliente_inicio").value,
            fim: document.getElementById("cliente_fim").value,
            nome: document.getElementById("cliente_nome").value,
            tel: document.getElementById("cliente_tel").value,
            email: document.getElementById("cliente_email").value,
            doc: document.getElementById("cliente_doc").value,
            valor: document.getElementById("cliente_valor").value
        };

        if (!cliente.nome || !cliente.valor) {
            alert("Preencha ao menos nome e valor do contrato!");
            return;
        }

        let clientes = JSON.parse(localStorage.getItem("clientes") || "[]");
        clientes.push(cliente);
        localStorage.setItem("clientes", JSON.stringify(clientes));

        mostrarClientes();
        alert("Cliente cadastrado com sucesso!");
    }

    // EXIBIR CLIENTES NA TELA
    function mostrarClientes() {
        const lista = document.getElementById("listaClientes");
        lista.innerHTML = "";

        const clientes = JSON.parse(localStorage.getItem("clientes") || "[]");

        clientes.forEach((c, i) => {
            lista.innerHTML += `
                <div style="padding:10px 0; border-bottom:1px solid #eee;">
                    <b>${c.nome}</b> — R$ ${c.valor}<br>
                    Início: ${c.inicio} • Fim: ${c.fim}<br>
                    Tel: ${c.tel}<br>
                    Email: ${c.email}<br>
                    CPF/CNPJ: ${c.doc}
                </div>
            `;
        });
    }

    // Carrega automaticamente
    window.onload = function() {
        if (localStorage.getItem("contas_meta")) {
            document.getElementById("btnMeta").innerText = "Conectado ✓";
            mostrarContas();
        }

        mostrarClientes();
    }

</script>
